<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>car</title>
</head>
<style>
    .over-hidden {
        overflow: hidden;
    }

    .dis-block {
        display: block;
    }

    .dis-flx {
        display: flex;
    }

    .flt-right {
        float: right;
    }

    .cus-pit {
        cursor: pointer;
    }

    .w50 {
        width: 50px;
    }
</style>

<body>
    <div class="container" style="width: 70%">

        <head>
            <h2>car</h2>

            <head>
                <section>
                    <table border="1" style="width: 100%;">
                        <thead>
                            <tr>
                                <th>
                                    <div>
                                        <label for="allCheck">ckeckAll</label>
                                        <input type="checkbox" name="allCheck" id="allCheck">
                                    </div>
                                </th>
                                <th>
                                    goodsPic
                                </th>
                                <th>
                                    goodsName
                                </th>
                                <th>
                                    goodsPrice
                                </th>
                                <th>
                                    goodsNum
                                </th>
                                <th>
                                    add/reduce
                                </th>
                                <th>
                                    singleGoodsAllPrice
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>
                                    <input type="checkbox" name="check">
                                </td>
                                <td>
                                    <div class="pic">
                                        <img class="dis-block w50" src="./images/watermelon.jpeg" alt="">
                                    </div>
                                </td>
                                <td>
                                    <div class="name">
                                        watermelon
                                    </div>
                                </td>
                                <td>
                                    <div class="price">
                                        $20.00
                                    </div>
                                </td>
                                <td>
                                    <div class="num">
                                        1
                                    </div>
                                </td>
                                <td>
                                    <div class="numChange dis-flx">
                                        <div class="reduce cus-pit">-</div>
                                        <input type="text" name="num" id="" value="1">
                                        <div class="add cus-pit">+</div>
                                    </div>
                                </td>
                                <td>
                                    <div class="singleGoodsAllPrice">
                                        $20.00
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <input type="checkbox" name="check">
                                </td>
                                <td>
                                    <div class="pic">
                                        <img class="dis-block w50" src="./images/apple.jpeg" alt="">
                                    </div>
                                </td>
                                <td>
                                    <div class="name">
                                        apple
                                    </div>
                                </td>
                                <td>
                                    <div class="price">
                                        $20.00
                                    </div>
                                </td>
                                <td>
                                    <div class="num">
                                        1
                                    </div>
                                </td>
                                <td>
                                    <div class="numChange dis-flx">
                                        <div class="reduce cus-pit">-</div>
                                        <input type="text" name="num" id="" value="1">
                                        <div class="add cus-pit">+</div>
                                    </div>
                                </td>
                                <td>
                                    <div class="singleGoodsAllPrice">
                                        $20.00
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <input type="checkbox" name="check">
                                </td>
                                <td>
                                    <div class="pic">
                                        <img class="dis-block w50" src="./images/pear.jpeg" alt="">
                                    </div>
                                </td>
                                <td>
                                    <div class="name">
                                        pear
                                    </div>
                                </td>
                                <td>
                                    <div class="price">
                                        $20.00
                                    </div>
                                </td>
                                <td>
                                    <div class="num">
                                        1
                                    </div>
                                </td>
                                <td>
                                    <div class="numChange dis-flx">
                                        <div class="reduce cus-pit">-</div>
                                        <input type="text" value="1" name="num" id="">
                                        <div class="add cus-pit">+</div>
                                    </div>
                                </td>
                                <td>
                                    <div class="singleGoodsAllPrice">
                                        $20.00
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <input type="checkbox" name="check">
                                </td>
                                <td>
                                    <div class="pic">
                                        <img class="dis-block w50" src="./images/peach.jpeg" alt="">
                                    </div>
                                </td>
                                <td>
                                    <div class="name">
                                        peach
                                    </div>
                                </td>
                                <td>
                                    <div class="price">
                                        $20.00
                                    </div>
                                </td>
                                <td>
                                    <div class="num">
                                        1
                                    </div>
                                </td>
                                <td>
                                    <div class="numChange dis-flx">
                                        <div class="reduce cus-pit">-</div>
                                        <input type="text" name="num" id="" value="1">
                                        <div class="add cus-pit">+</div>
                                    </div>
                                </td>
                                <td>
                                    <div class="singleGoodsAllPrice">
                                        $20.00
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <input type="checkbox" name="check">
                                </td>
                                <td>
                                    <div class="pic">
                                        <img class="dis-block w50" src="./images/banana.jpeg" alt="">
                                    </div>
                                </td>
                                <td class="name">
                                    banana
                                </td>
                                <td>
                                    <div class="price">
                                        $20.00
                                    </div>
                                </td>
                                <td>
                                    <div class="num">
                                        1
                                    </div>
                                </td>
                                <td>
                                    <div class="numChange dis-flx">
                                        <div class="reduce cus-pit">-</div>
                                        <input type="text" name="num" id="" value="1">
                                        <div class="add cus-pit">+</div>
                                    </div>
                                </td>
                                <td>
                                    <div class="singleGoodsAllPrice">
                                        $20.00
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <input type="checkbox" name="check">
                                </td>
                                <td>
                                    <div class="pic">
                                        <img class="dis-block w50" src="./images/grapes.jpeg" alt="">
                                    </div>
                                </td>
                                <td class="name">
                                    grapes
                                </td>
                                <td>
                                    <div class="price">
                                        $20.00
                                    </div>
                                </td>
                                <td>
                                    <div class="num">
                                        1
                                    </div>
                                </td>
                                <td>
                                    <div class="numChange dis-flx">
                                        <div class="reduce cus-pit">-</div>
                                        <input type="text" name="num" id="" value="1">
                                        <div class="add cus-pit">+</div>
                                    </div>
                                </td>
                                <td>
                                    <div class="singleGoodsAllPrice">
                                        $20.00
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </section>
                <footer>
                    <div class="over-hidden" style="padding: 10px;">
                        <div class="allPrice flt-right">
                            &nbsp;&nbsp;<span>allPrice:0</span>
                        </div>
                        <div class="allNum flt-right">
                            <span>allNum:$0</span>
                        </div>
                    </div>
                </footer>
    </div>
</body>
<script src="./js/jquery.js"></script>
<script>
    (function () {
        // 数量添加
        $('.add').on('click', function () {
            var value = $(this).prev().val();
            var price = $(this).parent().parent().prev().prev().children().html().split('$')[1];
            value = parseInt(value) + 1;
            $(this).prev().val(value);
            $(this).parent().parent().next().children().html('$' + value * price)
            all()
        })
        // 数量减少
        $('.reduce').on('click', function () {
            var value = $(this).next().val();
            var price = $(this).parent().parent().prev().prev().children().html().split('$')[1];
            if (value > 1) {
                value = parseInt(value) - 1;
                $(this).next().val(value);
                $(this).parent().parent().next().children().html('$' + value * price)
                all()
            } else {
                alert('亲，最小数量唯1哦！')
            }

        })
        // 全选/单选
        var checkAll = $("input[name='allCheck']");
        var check = $("input[name='check']");
        checkAll.click(function () {
            if ($(this)[0].checked === true) {
                for (const iterator of check) {
                    iterator.checked = true
                }
                all()
            } else {
                for (const iterator of check) {
                    iterator.checked = false
                }
                $('.allNum span').html('allNum:' + '0')
                $('.allPrice span').html('allPrice:$' + '0')
            }
        })
        check.on('click', function () {
            var bol = Array.from(check).every(function (item) {
                return item.checked === true
            })
            if (bol) {
                checkAll[0].checked = true
            } else {
                checkAll[0].checked = false
            }
            all()
        })
        // 输入框事件
        $('input[name=num]').on('input', function () {
            if ($(this).val()) {
                var value = $(this).val();
                var price = $(this).parent().parent().prev().prev().children().html().split('$')[1];
                $(this).parent().parent().next().children().html('$' + value * price)
                all()
            }
        })
        $('input[name=num]').on('change', function () {
            if (!$(this).val()) {
                $(this).val(0)
                var value = $(this).val();
                var price = $(this).parent().parent().prev().prev().children().html().split('$')[1];
                $(this).parent().parent().next().children().html('$' + value * price)
            }
        })
        // 计算总价/数量
        function all() {
            var checkAll = $("input[name='allCheck']");
            var check = Array.from($("input[name='check']"));
            var num = 0;
            var price = 0;
            var singleGoodsAllPrice = $('.singleGoodsAllPrice');
            var ipt = $("input[name='num']");
            check.forEach(function (item, index) {
                if (item.checked === true) {

                    num += parseInt(ipt[index].value)
                    $('.allNum span').html('allNum:' + num)

                    price += parseInt(singleGoodsAllPrice[index].innerHTML.split('$')[1])
                    $('.allPrice span').html('allPrice:$' + price)

                } else {
                    var isBol = check.some(function (item) {
                        return item.checked === true
                    })
                    if (!isBol) {
                        $('.allNum span').html('allNum:' + '0')
                        $('.allPrice span').html('allPrice:$' + '0')
                    }
                }
            })
        }
        all()
    })()
</script>

</html>